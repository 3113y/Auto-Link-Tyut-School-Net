# TYUT 教学管理服务平台自动登录工具

## 简介

这是一个用于自动连接太原理工大学（TYUT）教学管理服务平台的图形界面工具。它通过内置浏览器自动完成 VPN 登录和内网认证两个阶段，并提供了智能重试机制，确保在网络繁忙时也能成功连接。

## ✨ 功能特性

- **图形用户界面 (GUI)**：提供简单易用的操作界面，无需命令行基础。
- **双阶段自动登录**：
  - 自动完成 VPN 登录（vpn.tyut.edu.cn）
  - 自动跳转并登录教学管理服务平台（192.168.200.100）
- **两种登录模式**：
  - **登录一次**：手动触发单次登录尝试，失败后不自动重试
  - **自动重试**：智能检测登录状态，自动重试直到成功或达到次数上限
- **多服务器轮询**：配置多个 VPN 服务器地址（`vpn1`, `vpn2`, `vpn3`），程序会按顺序逐一尝试。
- **多密码支持**：
  - 支持分别配置 VPN 密码和教学管理服务平台密码
  - 如果两个密码相同，只需填写一次
- **配置管理**：
  - 启动时自动从 `scripts/config.json` 加载账号、密码和服务器地址
  - 点击"保存账号密码"按钮直接保存配置，无需手动选择位置
  - 支持从不同的配置文件中加载（切换账号）
- **实时日志**：在界面上实时显示当前的连接状态和操作日志，包括登录失败原因。
- **防止窗口堆积**：禁止创建新窗口，所有操作都在当前页面进行。
- **跨平台**：基于 Python 和 PyQt5，可在 Windows, macOS, Linux 上运行。

## 🚀 如何运行

### 方式一：直接运行可执行文件（推荐）

1. 下载最新的 Release 版本中的 `ATSN.exe` 文件
2. 双击运行即可，无需安装 Python 环境

### 方式二：从源码运行

1. 确保已安装 Python 环境和项目所需的依赖库(见requirements.txt)
2. 在项目根目录下运行以下命令：

    ```powershell
    python app.py
    ```

## ⚙️ 配置说明

程序启动时会自动读取 `scripts/config.json` 文件。你可以手动创建或修改此文件来预设登录信息。

一个典型的 `config.json` 示例如下：

```json
{
    "username": "你的学号",
    "vpn_password": "VPN密码",
    "local_password": "教学管理服务平台密码",
    "server_url": [
        "https://vpn1.tyut.edu.cn/prx/000/http/localhost/login",
        "https://vpn2.tyut.edu.cn/prx/000/http/localhost/login",
        "https://vpn3.tyut.edu.cn/prx/000/http/localhost/login"
    ],
    "retry_interval_secs": 5,
    "max_retries": 0
}
```

### 配置字段说明

- `username`: 你的学号
- `vpn_password`: VPN 登录密码（vpn.tyut.edu.cn）
- `local_password`: 教学管理服务平台密码（192.168.200.100）。如果与 VPN 密码相同，可以填写相同值
- `server_url`: VPN 服务器地址列表，程序会自动按列表顺序进行尝试
- `retry_interval_secs`: 重试间隔（秒），默认 5 秒
- `max_retries`: 最大重试次数，0 表示无限重试

你也可以在程序运行后，在界面上修改信息，并点击 **"保存账号密码"** 按钮来自动更新 `scripts/config.json` 文件。

## 📖 使用说明

1. **填写账号信息**：
   - 在界面中填写学号、VPN 密码和教学管理服务平台密码
   - 点击"保存账号密码"按钮保存配置

2. **选择登录模式**：
   - **登录一次**：适合测试或手动控制，失败后不会自动重试
   - **开始自动重试**：适合自动化场景，会持续重试直到成功

3. **查看日志**：
   - 右侧日志区域会实时显示登录状态和错误信息
   - 如果登录失败，会显示具体的失败原因

4. **停止重试**：
   - 点击"停止自动重试"按钮可以随时中止自动重试过程

## 🛠️ 技术栈

- **Python 3.9+**
- **PyQt5**: GUI 框架
- **PyQt5-WebEngine**: 内嵌浏览器支持
- **PIL (Pillow)**: 图像处理

## 📝 项目结构

```
Auto-Link-Tyut-School-Net/
├── app.py                      # 程序入口
├── autolink_modules/           # 模块化代码
│   ├── main_window.py         # 主窗口逻辑
│   ├── config_manager.py      # 配置管理
│   └── login_logic.py         # 登录逻辑
├── scripts/                    # 配置文件夹
│   └── config.json            # 用户配置文件
├── icon.ico                    # 应用图标
└── readme.md                   # 说明文档
```

## ⚠️ 注意事项

- 本工具仅供太原理工大学在校师生使用
- 请妥善保管你的账号密码，不要将配置文件分享给他人
- 如遇到登录问题，请查看日志区域的错误提示
- 本工具不存储或上传任何个人信息

## 📄 开源协议

本项目遵循 MIT 协议开源。

